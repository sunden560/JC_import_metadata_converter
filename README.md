# JAIRO Cloud 一括登録メタデータ作成ツール  
## 主な機能  
-	表形式で入力したデータを、JAIRO Cloud 一括登録テンプレートの形式に変換します。  
-	繰り返し可能項目（Allow Multiple）は、「;」（セミコロン）区切りで複数入力することができます。この場合、添え字を[0]から必要な数まで増やしてJSON形式パスを繰り返します。  
-	入力したデータの言語コードを、簡易的に判別することができます（日本語の文字コードが含まれる場合は「ja」、それ以外は「en」）  
-	著者名の「姓」のみまたは「名」のみを、一括登録用メタデータに変換することができます。  
## シート構成
- input・・・（必須）データ入力用
- mapping(＊＊＊＊＊)・・・（必須）一括登録ファイルへの項目マッピング設定
- JC一括登録テンプレート・・・JAIRO Cloud のアイテム管理画面から出力したテンプレートを貼り付け
- 著者区切り作成・・・著者名、所属の順序を揃えて区切るためのツール
- metadata(＊＊＊＊＊)・・・新規ブックに作成される一括登録用メタデータ
### データ入力シート
-	アイテムのメタデータを表形式で入力するためのシート
-	シート名は「input」
-	１列目の項目名は「mapping」
-	mapping列（１列目）に「＊＊＊＊＊」を入力すると、マッピング設定シート「mapping(＊＊＊＊＊)」に従って、新規作成ファイルの「metadata(＊＊＊＊＊)」シートに一括登録用メタデータが出力されます。
-	mapping列（１列目）が空白または対応するマッピングシートが存在しない行は、一括登録用メタデータが出力されません
-	項目名は重複しないこと
-	２列目以降の項目名は任意の項目名（一括登録用メタデータに出力しなくてもよい）を設定できます
-	複数データの入力を設定するときは、入力データを「;」（セミコロン）で区切ってください
### マッピング設定シート
-	データ入力シートから一括登録用メタデータ項目へのマッピング設定するためのシート  
-	シート名は「mapping(＊＊＊＊＊)」で、複数作成可能  
-	A列～E列に、JAIRO Cloud 一括登録用テンプレートのヘッダを、行列を入れ替えて貼り付けてください。この部分は繰り返し項目を除き、一括登録用メタデータのヘッダとしてそのまま出力されます。  
-	F列に「参照元項目」として、データ入力シートの項目名を設定してください（空白または項目名が存在しないときは、ヘッダのみ出力されます）  
-	G列に出力方法を設定してください（空白の場合はヘッダのみ出力されます）
    -	fixed・・・H列に設定した固定値を出力（空白の場合は出力しない）
    -	today・・・本日の日付（yyyy-mm-dd）を出力
    -	value・・・入力データをそのまま出力
    -	lang・・・入力データに日本語の文字コードが含まれる場合は「ja」 、それ以外は「en」を出力（空白の場合は出力しない）
    -	familyname・・・入力データの「,」より前の部分を出力（空白の場合は出力しない）
    -	givenname・・・入力データに「,」がある場合、それより後ろの部分を出力（空白の場合は出力しない）
    -	doi・・・DOIの形式「https://doi.org/***」の形式に変換して出力（空白の場合は出力しない）  
-	繰り返し可能項目（Allow Multiple）に複数データの入力を設定するときは、ラベルのサフィックスを「-1」にしてください。この場合、この項目がレベルのサフィックスが0から順に、データの個数分繰り返して出力されます。  
## 繰り返し項目のマッピング設定
### A　通常の繰り返し  
通常の一括登録用メタデータと同様に、内部キーとラベルをコピーして添え字の数字を編集します。それぞれの内部キーに対して、入力データの項目をマッピング設定する必要があります。  
### B　区切り記号による繰り返し  
１．	１つのセルに、「;」（セミコロン）区切りで複数のデータを入力します。  
２．	マッピング設定で内部キーの添え字番号を「-1」に変更します。  
## 実行方法  
1.	inputシートに入力データを入力してください  
2.	mapping(＊＊＊＊＊)シートで一括登録用メタデータへのマッピングを設定してください  
3.	マクロ「JC一括登録メタデータ作成」を実行してください  
「表示」→「マクロ」→「マクロの表示」で表示されるマクロ画面で、「JC一括登録メタデータ作成」を選択して「実行」ボタンをクリック  
4.	新規ブックが作成され、マッピング設定ごとに一括登録用メタデータのシート「metadata（＊＊＊＊＊）」が作成されます  

